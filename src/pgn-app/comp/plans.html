<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/polymer/lib/elements/dom-repeat.html">
<dom-module id="plans-comp">
    <template>
        <link rel="stylesheet" type="text/css" href="./src/pgn-app/comp/css/plan.css">
        <section id="plans">
            <h1 class="section-title">Choose Your Plan</h1>
            <div>
                <template is="dom-repeat" items={{articles}}>
                    <article id="article_{{item.title}}" class$="[[item.class.article]]">
                        <h1 class$=[[item.class.title]]>{{item.title}}</h1>
                        <h2 class$="[[item.class.price]]">{{item.price}}</h2>
                        <h3>{{item.desc}}</h3>
                        <ul class="plan__features">
                            <template is="dom-repeat" items={{item.features}}>
                                <li>{{item}}</li>
                            </template>
                        </ul>
                        <div>
                            <button id="{{item.title}}_{{index}}" on-click="handlePlanChange" class="button">CHOOSE PLAN</button>
                        </div>
                    </article>
                </template>
            </div>
        </section>
    </template>
    <script>
        class PlansComponent extends Polymer.Element {
            static get is() {
                return 'plans-comp';
            }

            handlePlanChange(event) {
                var currentSelectedPlanIndex = event.currentTarget.id.split('_')[1];
                if (currentSelectedPlanIndex !== this.lastSelectedPlanIndex) {
                    this.resetPlanClasses(currentSelectedPlanIndex, 'normal');
                    this.resetPlanClasses(this.lastSelectedPlanIndex, 'high');
                    this.set('lastSelectedPlanIndex', currentSelectedPlanIndex);
                }
            }

            resetPlanClasses(index, type) {
                var path = this.planClassPath.replace('-', index),
                        articleClass = path + '.article',
                        titleClass = path + '.title',
                        priceClass = path + '.price';
                    this.set(articleClass, type === 'normal' ? this.plan_highlighted.article: this.plan_normal.article);
                    this.set(priceClass, type === 'normal' ? this.plan_highlighted.price: this.plan_normal.price);
                    this.set(titleClass, type === 'normal' ? this.plan_highlighted.title: this.plan_normal.title);
            }

            static get properties() {
                return {
                    planClassPath: {
                        value() {
                            return 'articles.-.class'
                        }
                    },
                    plan_highlighted: {
                        value() {
                            return {
                                article: 'plan plan--highlighted',
                                title: 'plan__title plan__anotation',
                                price: 'plan__price'
                            }
                        }
                    },
                    plan_normal: {
                        value() {
                            return {
                                article: 'plan',
                                title: 'plan__title',
                                price: ''
                            }
                        }
                    },
                    lastSelectedPlanIndex: {
                        value() {
                            return 1;
                        }
                    },
                    articles: {
                        type: Array,
                        value() {
                            return [{
                                    title: 'FREE',
                                    class: {
                                        article: 'plan',
                                            price: 'plan__price'
                                    },
                                    price: '$99/month',
                                    desc: 'For hobby projects or small teams.',
                                    features: [
                                        '1 Workspace',
                                        'Unlimited Traffic',
                                        '10GB Storage',
                                        'Basic Support'
                                    ]
                                },
                                {
                                    title: 'RECOMMENDED',
                                    class: {
                                        article: 'plan plan--highlighted',
                                            title: 'plan__title plan__anotation',
                                            price: 'plan__price'
                                    },
                                    price: '$99/month',
                                    desc: 'For ambitious projects.',
                                    features: [
                                        '5 Workspaces',
                                        'Unlimited Traffic',
                                        '100GB Storage',
                                        'Plus Support'
                                    ]
                                },
                                {
                                    title: 'PREMIUM',
                                    class: {
                                        article: 'plan',
                                            price: 'plan__price'
                                    },
                                    price: '$99/month',
                                    desc: 'Your enterprise solution.',
                                    features: [
                                        '10 Workspace',
                                        'Unlimited Traffic',
                                        '500GB Storage',
                                        'Basic Support'
                                    ]
                                }
                            ];
                        }
                    }
                }
            }
        }
        window.customElements.define(PlansComponent.is, PlansComponent);
    </script>
</dom-module>